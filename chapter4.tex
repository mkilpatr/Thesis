\chapter{Search Strategy}
\label{ch:SearchStrategy}

\section{Physics Objects}\label{PhysObj}
There are many different types of physics objects that we are interested in when working with particle physics experiments. Since the particles that we are interested in have very short lifetimes, $\mathcal{O}(\text{decay})=10^{-23}$ s, we mainly interact with the decay products of the event, such as, jets $(N_j)$, heavy object tagging $(\nb, \nt, \nw, \nrt)$, missing transverse momentum (\met), scalar sum jet momentum $(H_T)$, soft-b tagging, denoted as $\nsv$, transverse mass between tagged $b$ quarks and \met{} $(m_T(b_{1,2}, \met))$, Initial State Radiation, and lepton identification.

\subsection{Jets}\label{Jets}
In an interaction whenever a quark is made it comes in pairs $(q\overline{q})$ such that the total color charge of the interaction is neutral. Typically due to conservation of momentum the quarks may originally be produced near the interaction point but will quickly start to move away from each other. Eventually the quarks will move far enough apart and will have enough potential energy in the gluon connections between them that it is now more efficient to create a new quark-antiquark $(q\overline{q})$ pair. This will continue to occur in a sequence of radiating gluons and producing new pairs of charged particles, see fig. \ref{JetHadronization}. In the final state, the energy deposited in the HCAL is due to a cluster of charged particles of a certain radius, $\Delta R=\sqrt{\Delta\eta^2+\Delta\phi^2}$. There are many algorithms to reconstruct the jets, we are mainly interested in the anti-kT Jet algorithm \cite{cacciari_anti-ktjet_2008} method which uses the transverse momentum of the particles within a certain radius $\Delta R = 0.4 (0.8)$ for AK4(AK8) jets \cite{noauthor_jetid_nodate, noauthor_jec_nodate}. Once the jets have been identified, we can analyse their respective properties to determine the likelihood of the particle it originated from, such as a $b, t, \text{ or } W$. 

\begin{figure}
 	\centering
	\includegraphics[width=0.75\textwidth]{JetHadronization.png}
 	\caption[Jet Hadronization]{A diagram of a quark pair radiating gluons that decay into more quark pairs in a process called hadronization \cite{griffiths_introduction_2008}.}
 	\label{JetHadronization} 
\end{figure}

\subsection{Heavy Object Tagging}\label{HeavyObject}
Since this search is looking for a massive particle which then decays to slightly less massive particles we need to be able to identify and distinguish between them. We use various algorithms and neural networks to identify jets from $b$ quarks, $t$ quarks, or from \W {} bosons. 

\subsubsection{B-Tagging}\label{Btagging}
Firstly, \B-tagged jets which are jets that are likely to have originated from a \B{} quark. For \B{} quarks with large transverse momentum, we use a Deep Combined Secondary Vertex (DeepCSV) algorithm that involves neural networks. \bjet s{} are identified using the Run 2 version of the Deep Combined Secondary Vertex (DeepCSV) algorithm \cite{noauthor_performance_nodate}. The medium working point recommended by the B-tag POG, corresponding to a threshold of 0.6324m 0.4941, and 0.4184 for the 2016, 2017, and 2018 respectively \cite{noauthor_btagrecommendation2016legacy_nodate, noauthor_btagrecommendation94x_nodate, noauthor_btagrecommendation102x_nodate}. The medium working point is defined such that the percentage of a light jet being misidentified as a \bjet{} is 1\%.

\begin{figure}
 	\centering
	\includegraphics[width=0.75\textwidth]{TopDecayBoost.png}
 	\caption[Top Decays]{The two types of top quark reconstuctions, when each decay product is easily identifiable (resolved) or when the particles are close together (boosted).}
 	\label{TopDecays} 
\end{figure}

\subsubsection{Top/W Tagging}\label{TopTagging}
The anti-kt algorithm using a distance parameter, $\Delta R=0.8$, is expected to contain the energy clusters of all of the decay product of boosted $t$ quarks, see Fig. \ref{TopDecays}, with $\pt>300$ \GeV{} or \W{} bosons with $\pt>200$ \GeV. The requirements are:
\begin{itemize}
	\item Medium working point $>0.937, 0.895, 0.895 (0.973, 0.991, 0.991)$ for boosted $t$ $(W)$ for the separate 2016, 2017, and 2018 eras, respectively.
	\item Reconstructed soft drop\cite{noauthor_soft_nodate} mass: $105<m_t<210$ \GeV{} and $65<m_W<105$ \GeV.
	\item Boosted tops: $\pt=300$ \GeV, $|\eta|<2.0$ and $W$: $\pt=200$ \GeV, $|\eta|<2.0$
\end{itemize}

There is another type of top that can be reconstructed, which is when each subjet of the top decay can be resolved into each individual jet, denoted as a resolved top, see Fig. \ref{TopDecays}. The requirements are:
\begin{itemize}
	\item Medium working point: 0.92 for all eras.
	\item $|\eta(j_{1,2,3})|<2.4$ and $b$-tag desciminator: $>0.6324, 0.4941, 0.4184$ for the separate 2016, 2017, and 2018 eras, respectively. The number of jets in the event that pass these cuts should be $\geq2$.
\end{itemize}
These object definitions, \nt, \nw, \nrt, are orthogonal to each other and are used to bin our search and control regions. 

\subsection{Missing Transverse Momentum}\label{MET}
The missing transverse momentum is the negative vector sum of the total transverse momentum measured in the detector,
\begin{equation}
\met=-\sum_{i\in\text{vis}}\overrightarrow{p}_{i, T},
\end{equation}
where the momentum runs over every visible(vis) particle in the event. Ideally, if the detector was $100\%$ efficient this quantity would always be zero due to conservation of momentum, but many things, such as detector efficiency, particles that are weakly interacting, or particles beyond the SM will cause the missing energy. Because of these, this object is a good discriminator for searching for physics beyond the SM. 

\subsection{MET Filters}
Need to add MET Filters here.

\subsection{$H_T$}\label{HT}
Another interesting quantity is $H_T$, which is the scalar sum of the \pt{} of all of the jets in an event,
\begin{equation}
H_T=\sum_{i\in\text{jets}}p_{i,T}.
\end{equation}
This quantity is quite useful when trying to identify massive particles and is quite good at suppressing QCD multijet background.

\subsection{Soft $b$-Tagging}\label{SV}

The ability to identify secondary vertices is essential in searches for the top squark, see Sec. \ref{sec:Production}. Since the b quark is a long lived particle, about $10^{-12}$ seconds, that will travel many millimeters before decaying into other particles. A \B{} quark is identified during reconstructing where the jet originating from, known as the secondary vertex $(SV)$, and then compare the distance away from the interaction point, known as the primary vertex $(PV)$. The displaced vertex of the long lived $b$ quark with low \pt{} has many interesting kinematic properties that we can use to identify them, known as soft $b$-tagging. 

\begin{figure}
 	\centering
	\includegraphics[width=0.75\textwidth]{SecondaryVertex.png}
 	\caption[Secondary Vertex Diagram]{A interaction that produces a long lived particle that has a reconstruced SV.}
 	\label{SecondaryVertex} 
\end{figure}

This search also targets models that produce very soft bottom or charm quarks. A large fraction of events contain b quarks with \pt{} below the 20 GeV jet \pt{} threshold which may thus fail to be reconstructed as jets or become b-tagged. Identification of these soft quarks improves our ability to separate potential signal events from the SM background. We therefore aim to identify $b$ or $c$ quarks based on the presence of a SV reconstructed using the Inclusive Vertex Finder (IVF) \cite{noauthor_inclusivesecondaryvertexfinder_nodate}. Additional requirements on SV observables are applied to suppress the background originating from light quarks. These selected SV may be referred to as soft $b$-tags and are constructed to be orthogonal to the jets and b-tagged jet used in this analysis. 

The requirements on each SV to pass the soft b-tagging definition are:
\begin{itemize}
	 \item The distance in the transverse plane between the SV and the PV $\leq3$ cm.
	 \item The significance of the distance, SIP3D, between the SV and thePV $\geq4$.
	 \item The pointing angle, defined as $\cos(\overrightarrow{PV,SV},\overrightarrow{p_{SV}})\geq0.98$, where $\overrightarrow{p_{SV}}$ is the total four-momentum of the tracks associated to the SV. 
	 \item The number of tracks associated to the SV is greater or equal to 3.
	 \item The \pt{} of the SV is less than 20 GeV.
\end{itemize}
Identification of soft b-quarks is necessary for potential signal region where the stop does not directly decay into a top quark and is essential for some of our search region bins. 

\subsection{Transverse Energy between $b$ quarks and \met}
We will end up dividing the search regions we are interested in into two different groups. They will be distinguished by a parameter known as the transverse mass between the leading \bjet{} and \met{} defined as:
\begin{equation}\label{TransverseMass}
\mtb=\sqrt{2\cdot\met\cdot\pt(b)(1-\cos(\slashed{E}_\phi,p_{T\phi}(b)))},
\end{equation}
where \pt(b) is the momentum of the leading \bjet{} and $\slashed{E}_\phi$ is the $\phi$ component of the missing energy. This will be used to distinquish between our low and high mass search regions, see Section \ref{SearchRegions}.


\subsection{Initial-state Radiation}\label{ISRpt}

Initial-state radiation (ISR) may be clustered into one of the large-$R$ jets clustered with a distance parameter, $\Delta R=0.8$. We use the larger radius jets to be sensitive to ISR with gluon splitting, when a jet radiates a gluon that pair produces two quarks. The ISR jet is identified as being the hardest of the large-$R$ jets with $\pt>200$ GeV which fails the loose b-tagging working point and is not identified as a top or W. 
 
 \subsection{Electron and Muon Identification}\label{EleMuonID}
 There are two sets of selection criteria used in the analysis for electrons and muons. A set of veto criteria are used to efficiently reject events with an isolated electron of muon in the search region, while more stringent requirements are imposed in some control regions that require high purity samples of isolated leptons. The "Veto" working point is used to keep events with electrons out of the final search region. The "Medium" working point is used for the selection of leptonic control regions. The loose muon definition recommended by the Muon POG is used for the purposes of the muon veto. A loose muon is identified as a Particle Flow\cite{noauthor_cms_nodate} muon and can be either a global muon or an arbitrated tracker muon. Only candidates with transverse (longitudinal) impact parameter $|d_0|<0.2$ cm $(|d_z|<0.5 \text{cm},)$ with respect to the primary vertex, are considered. Electrons and muons are considered to fulfill the veto isolation criteria if their mini-isolation is less than 0.1 or 0.2 respectively, relative to the lepton \pt. The same thresholds are applied on the relative mini-isolation for electrons and muons in control samples. 
 
\subsection{Tau Identification}\label{TauID}
The Tau ID has been studied extensively in tests which looked into the custom MVA \cite{roe_boosted_2004, hoecker_tmva_2007} similar to the one used in Ref. \cite{noauthor_search_nodate}, the cut-based IsoTrack method, and Tau POG MVA method of identifying hadronically decaying taus. The methods which provide the best improvement to the efficiency of identifying taus with a small fake rate is the combination of IsoTrack and Tau POG MVA. With the inclusion of the combined method for identifying hadronically decaying taus, the veto percentage is $\approx29.0\%(7.2\%)$ with a efficiency of the veto of $\approx49.1\%(22.6\%)$ for SM background (signal), see Appendix. \ref{sec:TauMVA}. 

\section{Samples}\label{Samples}
\input{tables/samples.tex}


\subsection{Filters}
The following filters, recommended by the JetMET POG, are applied to 2016, 2017, and 2018 eras:
\begin{itemize}
	\item goodVertices
	\item HBHENoiseFilter
	\item HBHENoiseIsoFilter
	\item EcalDeadCellTriggerPrimitiveFilter
	\item BadPFMuonFilter
	\item GlobalSuperTightHalo2016Filter
	\item eeBadScFilter
\end{itemize}
There is an addition ecalBadCalibFilter for 2017 and 2018 eras only.

\section{Baseline Selection} \label{sec:Baseline}

Following the same methods as above, we have a loose pre-selection which is referred to as the baseline selection. This will place a selection on jets and \met which is used to eliminate a large fraction of background events. We define the baseline selection as:
\begin{itemize}
	\item $N_{e,(\mu)} = 0, (\pt>5$ \GeV, $|\eta|<2.5(2.4), \text{miniISO}<0.1(0.2))$
	\item $N_{isoTrk} = 0, (\pt > 5 (10)$ \GeV, ISO $< 0.2(0.1) \text{ for electron/muons(pions)})$
	\item $N_{tauPOG} = 0, (\pt > 20$ \GeV, $|\eta|<2.4)$, medium working point
	\item $N_{j} \geq 2, (\pt >20$ \GeV, $|\eta|<2.4)$
	\item $\met >250$ \GeV, to reach the plateau of the trigger efficiency
	\item $\Ht>300$ \GeV
	\item HEM Veto for part of 2018 data: $-3\leq\eta\leq-1.4, -1.57\leq\phi\leq-0.87$
\end{itemize}
In Addition to this, we allow for two separate sets of additional selections to apply to the low and high \dm{} search regions to further reduce background. The high \dm{} baseline selection includes the baseline selection and additionally,
\begin{itemize}
	\item $N_j\geq 5, (\pt >20$ \GeV, $|\eta|<2.4)$
	\item $N_b\geq 1, (\pt >20$ \GeV, $|\eta|<2.4)$, medium DeepCSV working point
	\item $\text{Min}[|\Delta\phi(\met,j_1)|,|\Delta\phi(\met,j_2)|,|\Delta\phi(\met,j_3)|,|\Delta\phi(\met,j_4)|]\equiv\Delta\phi_{1234}>0.5$, where $j_1, j_2, j_3, j_4$ are the four leading jets in $p_T$. This requirement is to reduce the QCD multijet background. 
\end{itemize}
Next, the low \dm{} baseline selection has the following addition selections,
\begin{itemize}
	\item $N_t=0, N_W=0,N_{res}=0,$ where $N_t$ and $N_W$ are the number of merged tops and \W's, respectively, and $N_{res}$ is the number of resolved tops
	\item An ISR jet as defined in Sec. \ref{ISRpt} with $\pt(ISR)>200$ \GeV, $|\eta|<2.4, |\Delta\phi(j_{ISR},\met)|>2.$
	\item $\met/\sqrt{H_{T}}\equiv S_{\met}>10$, where $H_T$ is calculated as the scalar sum of the \pt of jets with $\pt >20$ \GeV{} and $|\eta|<2.4.$
	\item $|\Delta\phi(\met,j_1)|>0.5, |\Delta\phi(\met,j_{2,3})|>0.15$, where $j_1,j_2,j_3$ are the three leading jets in \pt. 
\end{itemize}

\subsection{Search Regions}\label{SearchRegions}

After applying the baseline selection criteria, we categorize events in the search sample into exclusive search regions that exploit the kinematic properties of different signal topologies. 

For the search regions that mainly target high \dm{} signal models, we define two event categories in \mtb,see Section \ref{TransverseMass}, a variable defined as
\begin{equation}
\mtb\equiv
\begin{cases}
\begin{split}
m_T(b,\met), &\nb=1 \\
\text{Min}[m_T(b_1, \met),m_T(b_2,\met)], &\nb\geq2 \\
\end{split}
\end{cases}
\end{equation}
where $b_1, b_2$ are the two selected b-tagged jets with the highest values of the DeepCSV discriminator. In \ttbar{} events where one of the \W{} bosons undergoes a leptonic decay and the lepton is missed, leading to \met{}, the transverse mass of \met{} and the b-quark from the same top decay as the missed lepton has a kinematic endpoint at the mass of the top-quark. We therefore define two event categories: $\mtb>175~\GeV$ (\ttbar-depleted) and $< 175~\GeV$ (\ttbar-enhanced), see fig. \ref{StopParameterSpace}. In the low-\mtb{} category, to target signal models with moderate values of \dm, we define search regions by requiring $\nj\geq7$ to benefit from potential ISR in signal events while suppressing the SM background, and $\nrt\geq1$. Events are then subdivided according to the number of b-tagged jets $(\nb=1,\geq2)$ and different \met{} thresholds. The same subdivision is performed for events in the high-\mtb{} category with $\nj\geq7$, but containing no top- or W-tagged candidates. We then target signal models with sufficiently boosted top quarks or W bosons by defining categories in the high-\mtb region that require the presence of at least one top- or W-tagged candidate. These categories do not have any further \nj{} requirement beyond that of the high \dm{} baseline selection, and are further subdivided according to $\nb, \met, \Ht$ and the number of each kind of top- and W-tagged candidate. Table \ref{tab:searchregions-hm} summarizes the definitions of all 130 disjoint search regions targeting high \dm{} signal models.

Events originating from low \dm{} signal models are likely to have lower values of \mtb. We therefore only use the low-\mtb{} category, and events with no b-tagged jets, to define search regions targeting these signal models. These search regions are further defined by the number of b-tagged jets, the number of identified secondary vertices \nsv, the ISR jet \pt, \ptb, and \met. Events in the $\nb=0$ category, which targets very compressed signal models, are further subdivided according to \nj. Only events with very high ISR $\pt(>500~\GeV)$ are selected in this category, which is also categorized by the presence or absence of soft b-tagged secondary vertices. Events in the $\nb=1$ category are further characterized according to the \pt{} of the b-tagged jet into two sub-categories, while those in the $\nb\geq2$ are subdivided based on \ptbonetwo{} into three sub-categories, in order to take advantage of the softer b jet \pt{} spectrum expected in signal events compared to the SM background. 

\begin{figure}
 	\centering
	\includegraphics[width=0.75\textwidth]{topSquark_mass_decayModes.pdf}
 	\caption[Top Squark Decay Modes]{Mass parameter space for different decay modes of the top squark.}
 	\label{StopParameterSpace} 
\end{figure}

Orthogonality to the high \dm{} event categories is achieved mostly by the \mtb{} categorization. Events with $\nb=0$, which cannot be categorized by \mtb, may enter only the low \dm{} event categories by virtue of the requirement $\nb\geq1$ of the high \dm{} baseline selection. Events with $\mtb<175~\GeV$ may enter high-\dm{} category only if they satisfy $\nrt\geq1$, and therefore do not pass the low-\dm{} baseline selection with its veto of top and W candidates. Table \ref{tab:searchregions-lm}  summarizes the definitions of the 53 disjoint search regions targeting low \dm{} signal models. The numbers are based on simulation and correspond to an integrated luminosity of \datalumi.

\input{tables/searchregions.tex}
